# 创建型设计模式学习笔记

本文总结了**创建型五种设计模式**的核心内容，包括特点、适用场景、关键点、示例和复习技巧，方便快速理解与回顾。

---

## 目录

1. [设计模式概念](#设计模式概念)
2. [创建型设计模式概览](#创建型设计模式概览)
3. [抽象工厂模式（Abstract Factory）](#抽象工厂模式abstract-factory)
4. [工厂方法模式（Factory Method）](#工厂方法模式factory-method)
5. [原型模式（Prototype）](#原型模式prototype)
6. [单例模式（Singleton）](#单例模式singleton)
7. [构建器模式（Builder）](#构建器模式builder)
8. [复习技巧与口诀](#复习技巧与口诀)

---

## 设计模式概念

- **定义**：针对特定问题的高质量、可复用解决方案。
- **目的**：提高代码质量、可维护性与开发效率。
- **原则**：
  1. 理解问题背景。
  2. 学会使用对应模式解决问题。
  3. 不必记忆所有模式，但常用的23种需要掌握。

---

## 创建型设计模式概览

| 模式 | 英文 | 特点 | 适用场景 | 区别 |
|------|------|------|----------|------|
| 抽象工厂 | Abstract Factory | 提供接口创建一系列相关对象，无需指定具体类 | 系统需要独立于产品创建、组合多类产品 | 一次可创建多个对象 |
| 工厂方法 | Factory Method | 定义创建对象接口，由子类决定具体类 | 需要延迟对象创建、由子类决定具体产品 | 一次只创建一个对象 |
| 原型 | Prototype | 通过拷贝已有实例快速创建新对象 | 对象创建开销大或需要大量相似对象 | 基于已有对象克隆 |
| 单例 | Singleton | 确保类只有一个实例，全局访问 | 配置管理、日志系统等 | 控制实例唯一性 |
| 构建器 | Builder | 将对象构建与表示分离，同样构建过程生成不同结果 | 对象构建复杂，步骤固定，组成可变 | 构建过程固定，最终表示可变 |

---

## 抽象工厂模式（Abstract Factory）

**特点**：

- 提供接口创建一系列相关或依赖对象
- 无需指定具体类
- 一次可创建多个对象

**流程示意**：

1. 定义产品父类（A类、B类）。
2. 定义抽象工厂接口，提供创建方法。
3. 具体工厂继承抽象工厂，实现创建方法。
4. 客户端调用具体工厂得到对象。

**示例 Python**：

    # 产品父类
    class AbstractA:
        pass

    class AbstractB:
        pass

    # 具体产品
    class A1(AbstractA):
        pass

    class B1(AbstractB):
        pass

    # 抽象工厂
    class AbstractFactory:
        def create_a(self):
            pass
        def create_b(self):
            pass

    # 具体工厂
    class Factory1(AbstractFactory):
        def create_a(self):
            return A1()
        def create_b(self):
            return B1()

**关键点**：

- 接口返回父类，子工厂实现具体对象
- 可组合多类产品
- 客户端通过工厂得到产品

---

## 工厂方法模式（Factory Method）

**特点**：

- 定义创建对象的接口，由子类决定实例化哪一个类
- 一次只生产一个产品
- 创建延迟，具体由子类实现

**流程示意**：

1. 定义产品接口/父类。
2. 定义工厂接口，声明工厂方法。
3. 具体工厂实现工厂方法创建具体产品。
4. 客户端调用具体工厂方法获取对象。

**示例 Python**：

    class Product:
        pass

    class ConcreteProduct(Product):
        pass

    class Factory:
        def factory_method(self):
            pass

    class ConcreteFactory(Factory):
        def factory_method(self):
            return ConcreteProduct()

**关键点**：

- 工厂方法名决定模式名称
- 一次只创建一个对象
- 子类决定具体产品

---

## 原型模式（Prototype）

**特点**：

- 通过拷贝已有实例快速创建新对象
- 提高创建效率
- 对象含大量数据时特别适用

**流程示意**：

1. 定义可拷贝接口（Cloneable）。
2. 对象实现拷贝方法。
3. 客户端调用拷贝方法得到新对象。

**示例 Python**：

    import copy

    class Prototype:
        def __init__(self, data):
            self.data = data
        def clone(self):
            return copy.deepcopy(self)

    obj1 = Prototype([1,2,3])
    obj2 = obj1.clone()

**关键点**：

- 写一次拷贝，多次使用
- 对象父类可统一接收拷贝结果
- 高效创建对象

---

## 单例模式（Singleton）

**特点**：

- 确保一个类只有一个实例
- 提供全局访问点

**实现流程**：

1. 构造方法设为私有。
2. 静态成员保存唯一实例。
3. 提供静态方法获取实例，创建时检查是否已存在。

**示例 Python**：

    class Singleton:
        _instance = None

        def __new__(cls):
            if cls._instance is None:
                cls._instance = super().__new__(cls)
            return cls._instance

    a = Singleton()
    b = Singleton()
    assert a is b  # True

**关键点**：

- 私有构造函数 + 静态访问方法
- 内存节约、全局唯一
- static 关键字（语言相关）用于全局访问

---

## 构建器模式（Builder）

**特点**：

- 将复杂对象的构建与表示分离
- 相同构建过程可得到不同表示
- 常用于复杂对象或多步骤构建

**流程示意**：

1. **Product**：最终复杂对象。
2. **Builder**：定义构建步骤接口。
3. **ConcreteBuilder**：实现具体构建步骤。
4. **Director**：负责指导构建顺序、传入数据。
5. **Client**：调用 Director 获取对象。

**示例 Python**：

    class Product:
        def __init__(self):
            self.parts = []

    class Builder:
        def build_part(self, data):
            pass
        def get_result(self):
            pass

    class ConcreteBuilder(Builder):
        def __init__(self):
            self.product = Product()
        def build_part(self, data):
            self.product.parts.append(data)
        def get_result(self):
            return self.product

    class Director:
        def __init__(self, builder):
            self.builder = builder
        def construct(self, data_list):
            for data in data_list:
                self.builder.build_part(data)
            return self.builder.get_result()

    builder = ConcreteBuilder()
    director = Director(builder)
    product = director.construct(['主菜', '配料'])

**关键点**：

- 构建步骤固定，数据不同，最终对象外观不同
- Builder 封装构建逻辑
- Director 指导顺序并传入数据

---

## 复习技巧与口诀

1. **纵向分类**：
   - 创建型（五种）、结构型（七种）、行为型（十一种）
2. **结构型口诀**：
   - “四桥组装外向带” → 记住结构型七种
3. **类类型结构四种**：
   - “公司有一个模特小姐姐”
4. **创建型模式特点**：
   - 看名字就能知道与对象创建相关
5. **理解重于记忆**：
   - 结合 UML 图理解模式结构与关系
6. **复习流程**：
   1. 理解问题背景  
   2. 理解模式特征  
   3. 结合代码/流程图复习  
   4. 回顾口诀和分类  

---

> 本文整理自课堂讲解，含表格、流程与 Python 示例，便于快速复习和理解创建型设计模式。
